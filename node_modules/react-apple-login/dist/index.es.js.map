{"version":3,"file":"index.es.js","sources":["../src/helper.tsx","../src/index.tsx"],"sourcesContent":["\nconst generateQueryString = (q: any) => {\n  let queryString = '';\n  if (q) {\n    const queryKeys = Object.keys(q);\n    queryKeys.forEach(key => {\n      if (q[key]) {\n        if (q[key].toString().length) {\n          queryString += `${key}=${q[key]}&`;\n        }\n      }\n    });\n    if (queryKeys.length > 0 && queryString[queryString.length - 1] === '&') {\n      queryString = queryString.slice(0, -1);\n    }\n  }\n  return queryString;\n};\n\nexport { generateQueryString };\n","import React, { useEffect } from \"react\";\nimport { generateQueryString } from \"./helper\";\n\nexport interface AppleLoginProps {\n  clientId: string;\n  redirectURI: string;\n  autoLoad?: boolean;\n  scope?: string;\n  state?: string;\n  responseType?: string | \"code\" | \"id_token\";\n  responseMode?: string | \"query\" | \"fragment\" | \"form_post\";\n  nonce?: string;\n  designProp?: {\n    // REF: https://developer.apple.com/documentation/signinwithapplejs/incorporating_sign_in_with_apple_into_other_platforms\n    height?: number;\n    width?: number;\n    color?: string | \"white\" | \"black\";\n    border?: boolean;\n    type?: string | \"sign-in\" | \"continue\";\n    border_radius?: number;\n    scale?: number;\n    locale?: string;\n  };\n  callback?: (d: any) => void;\n  render?: (props: {\n    onClick: (e?: any) => void;\n    disabled?: boolean;\n  }) => JSX.Element;\n}\n\nconst AppleLogin = (props: AppleLoginProps) => {\n  const {\n    clientId,\n    redirectURI,\n    state = \"\",\n    render,\n    designProp = {},\n    responseMode = \"query\",\n    responseType = \"code\",\n    nonce,\n    callback,\n    scope,\n    autoLoad = false\n  } = props;\n\n  const onClick = (e: any = null) => {\n    if (e) {\n      e.preventDefault();\n    }\n    window.location.href = `https://appleid.apple.com/auth/authorize?${generateQueryString(\n      {\n        response_type: responseType,\n        response_mode: responseMode,\n        client_id: clientId,\n        redirect_uri: encodeURIComponent(redirectURI),\n        state,\n        nonce,\n        scope: responseMode === \"query\" ? \"\" : scope\n      }\n    )}`;\n  };\n\n  useEffect(() => {\n    if (autoLoad) {\n      onClick();\n    }\n\n    if (\n      typeof callback === \"function\" &&\n      responseMode === \"query\" &&\n      responseType === \"code\" &&\n      window &&\n      window.location\n    ) {\n      let match;\n      const pl = /\\+/g, // Regex for replacing addition symbol with a space\n        search = /([^&=]+)=?([^&]*)/g,\n        decode = (s: any) => {\n          return decodeURIComponent(s.replace(pl, \" \"));\n        },\n        query = window.location.search.substring(1);\n\n      let urlParams = {};\n      while ((match = search.exec(query))) {\n        urlParams[decode(match[1])] = decode(match[2]);\n      }\n      if (urlParams[\"code\"]) {\n        callback({\n          code: urlParams[\"code\"]\n        });\n      }\n    }\n    return () => {};\n  }, []);\n\n  if (typeof render === \"function\") {\n    return render({ onClick });\n  }\n\n  return (\n    <div id=\"appleid-signin\" onClick={onClick}>\n      <img\n        src={`https://appleid.cdn-apple.com/appleid/button?${generateQueryString(\n          designProp\n        )}`}\n      />\n    </div>\n  );\n};\n\nexport default AppleLogin;\n"],"names":[],"mappings":"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"}